---
title: Gatsby에 Category 필터링 기능 만들기
date: 2021-07-11
slug: /blog/gatsby/category/filter
categories: ['all','gatsby']
---

**Gatsby에 Category 기능 구현하기** 글에서 우리는 Gatsby에서 제공하는 방법으로 카테고리 기능을 구현해보았습니다.

여러분은 Gatsby가 지원하는 방식에 대해 어떻게 느끼셨나요? :question::question:

저는 Gatsby가 제공해주는 방법이 조금 아쉽게 느껴졌습니다.

frontmatter에 categories 속성을 제공해 개별 카테고리 페이지를 만든다는 것 자체는 굉장히 신기했으며 재밌었지만

>굳이 카테고리를 위해 페이지를 생성해야 할까?

라는 생각이 들기도 했습니다.

추측컨대 이것은 아마도 Gatsby가 카테고리별로 해당하는 데이터를 받도록 하여 모든 카테고리의 데이터를 가져오는 것이 아니라

일부분만 받아 GraphQL Server의 부담감을 줄여주기 위함이 아닐까 싶습니다.

예를 들어 Gatsby 카테고리 페이지에서는 Gatsby에 관련된 데이터만 받아오기 때문에 모든 데이터를 받아오는 것보단 로딩속도가 빠를 것 입니다.

이러한 장점이 존재하겠지만 저는 Gatsby에서 제공하는 방식을 채택하지 않을 것 입니다.

저는 어찌 되었든 `/blog` 내에서 블로그 카테고리를 보여주고 싶으며 해당 카테고리를 클릭할 때마다 관련된 데이터를 사용자에게 보여주고 싶습니다.

이는 초반에 모든 카테고리에 대한 글을 불러와 서버의 부담감을 초래하겠지만 추후에 paginator 기능을 추가하여 이 문제를 해결해보려고 합니다. :relaxed:

## 카테고리 필터링 기능 추가하기

방법을 제시하기 전에 제 방법이 정답이 아닐수도 있다는 점을 말씀드리고 싶습니다.

Gatsby가 제공하는 방식이 한가지밖에 없는 것은 Gatsby가 생각하기에 가장 적합한 방식이라고 생각되었기 때문일 것 입니다.

따라서 Gatsby가 제공하는 방법 외에 다른 방법으로 시도해보시고 싶은 분들께 아래의 방법을 추천드리도록 하겠습니다.

### Markdown 또는 Mdx에 Categories 추가하기

처음 해야할 것은 자신이 블로그 포스팅 글로 사용하고 있는 `Markdown` 또는 `Mdx`에서 frontmatter에 categories를 제공하는 것 입니다.

```js
---
title: Gatsby에 Category 필터링 기능 만들기
date: 2021-07-11
slug: /blog/gatsby/category/filter
categories: ['all','gatsby']
---
```

### Blog Page Query 수정하기

`src/pages/blog.tsx` 컴포넌트로 이동해 GraphQL Query문을 수정할 것 입니다.

`query`
```tsx
export const query = graphql`
  query BlogAllMdx {
    allMdx {
      totalCount
      group(field: frontmatter___categories) {
        kind: fieldValue
        totalCount
      }
      edges {
        node {
          id
          frontmatter {
            title
            date(formatString: "MMMM DD, YYYY")
            categories
          }
          fields {
            slug
          }
          excerpt
        }
      }
    }
  }
`;
```

group 필드로부터 우리가 작성한 Markdown 또는 Mdx frontmatter___categories 전부를 가져올 것 입니다.

저장 후에 `npm run apollo:codegen` 명령어를 실행하여 Type을 생성하도록 하세요.

그리고 Interface를 적용하도록 하겠습니다.

```tsx
import { BlogAllMarkDownRemark } from '@src/types/graphql';

interface BlogPageProps {
  data: BlogAllMarkDownRemark;
  pageContext: any;
}

const BlogPage = ({ data }: BlogPageProps) => {
  ...
}
```

이제 BlogPage에서 `categories` 리스트를 받아오도록 합시다.

```tsx
const BlogPage = ({ data }: BlogPageProps) => {
  return (
    <Layout>
      <header>
        <h1>Blog Page</h1>
        <nav>
          <ul>
            {data.allMdx.group.map((category) => (
              <li key={category.kind}>
                <Link
                  to={`/blog/?category=${category.kind}`}
                >{`${category.kind} (${category.totalCount})`}</Link>
              </li>
            ))}
          </ul>
        </nav>
      </header>
      <section>
        <article>
          ...
        </article>
      </section>
    </Layout>
  );
};
```

카테고리를 클릭하면 해당 링크로 이동할 수 있도록 설정하였습니다.

서버가 정상적으로 작동하는지 확인한 후, `http://localhost:8000/blog`로 이동하세요.

![Gatsby Category Filter 01](./gatsby-category-filter-01.PNG 'Blog Page')

좋습니다! :thumbsup:

현재는 아무런 컨텐츠도 없지만 카테고리 리스트를 가져와 사용자에게 보여줄 수 있습니다.

그리고 카테고리를 클릭하면 해당링크로 이동되는 것을 확인할 수도 있습니다.

현재까지는 카테고리를 클릭해도 아무런 변화가 없겠지만 차차 클릭 후에 기능을 추가할 것 입니다.